<!DOCTYPE html>
<html>
<body>
<h1>Fantasy Football!</h1>
<p id=leaders_weekly></p>
<script>
    var info = '{{scores_info | tojson}}';
    var info_obj = JSON.parse(info);
    // scores_info column information:
    // info_obj[0][0] = team id
    // info_obj[0][1] = player id
    // info_obj[0][2] = team name
    // info_obj[0][3] = player score
    // info_obj[0][4] = player name
    // info_obj[0][5] = gameweek
    // info_obj[0][6] = position
    // info_obj[0][7] = subbed

    var fixtures = '{{fixtures | tojson}}';
    var fixtures_obj = JSON.parse(fixtures);
    // fixtures column information:
    // fixtures_obj[0][0] = player 1
    // fixtures_obj[0][1] = player 2
    // fixtures_obj[0][2] = gameweek


    function unique(value, index, self) { 
        return self.indexOf(value) === index;
    }
    function scoresPerWeek(){
        // function to get the each team's score for every gameweek
        var players = []
        var gameweek = 1;
        var gameweek_scores = {};
        // create object with a key for each gameweek to hold each team's score for that gameweek
        for (i=0; i < info_obj.length; i++){   
            if (!(info_obj[i][5] in gameweek_scores)){
                gameweek_scores[info_obj[i][5]] = {};
            }
        }
        // iterate over all rows
        for (i=0; i < info_obj.length; i++){
            // add the score of player in current row to appropriate team and gameweek in gameweek_scores object if player is in first 11 positions
            if (info_obj[i][6] <= 11 & !(info_obj[i][2] in gameweek_scores[info_obj[i][5]])){
                gameweek_scores[info_obj[i][5]][info_obj[i][2]] = info_obj[i][3]
            }
            else if (info_obj[i][6] <= 11 & (info_obj[i][2] in gameweek_scores[info_obj[i][5]])){
                gameweek_scores[info_obj[i][5]][info_obj[i][2]]+= info_obj[i][3]
            }
        }
        return gameweek_scores
    }


    var scores_each_week = scoresPerWeek();

    function pointsPerWeek(){
        // function to find each player's head to head points per gameweek
        for (i = 0; i > fixtures_obj.length; i++ ){
            document.getElementById('leaders_weekly').innerHTML += "fixtures_obj[i]";
        }
    }


</script>
</body>
</html>